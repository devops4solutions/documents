"use strict";(self.webpackChunkdevops4solution=self.webpackChunkdevops4solution||[]).push([[698],{899:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var a=t(8168),o=(t(6540),t(5680));t(1873);const r={title:"Kubernetes Labels and Annotation",date:"2020-12-23",categories:["devops-tools"]},l=void 0,i={unversionedId:"Kubernetes/labels-and-annotations",id:"Kubernetes/labels-and-annotations",title:"Kubernetes Labels and Annotation",description:"Check out my Youtube video on this blog",source:"@site/docs/Kubernetes/labels-and-annotations.md",sourceDirName:"Kubernetes",slug:"/Kubernetes/labels-and-annotations",permalink:"/documents/docs/Kubernetes/labels-and-annotations",draft:!1,editUrl:"https://devops4solutions.github.io/docs/edit/main/docs/Kubernetes/labels-and-annotations.md",tags:[],version:"current",frontMatter:{title:"Kubernetes Labels and Annotation",date:"2020-12-23",categories:["devops-tools"]},sidebar:"tutorialSidebar",previous:{title:"Kubernetes Pods explained with examples",permalink:"/documents/docs/Kubernetes/kubernetes-pods-examples"},next:{title:"Understand Kubernetes Object and Create Nginx Deployment",permalink:"/documents/docs/Kubernetes/objects"}},s={},p=[{value:"<strong>Agenda</strong>:",id:"agenda",level:3},{value:"<strong>Labels</strong>",id:"labels",level:3},{value:"<strong>Organize Pods by team/project/organization</strong>",id:"organize-pods-by-teamprojectorganization",level:4},{value:"<strong>Run a Pod on Specific Nodes</strong>",id:"run-a-pod-on-specific-nodes",level:4},{value:"<strong>Create a Pod with Labels</strong>",id:"create-a-pod-with-labels",level:3},{value:"Adding Labels to a Running\xa0Pod",id:"adding-labels-to-a-runningpod",level:3},{value:"Selecting Kubernetes Objects Using Label Selectors",id:"selecting-kubernetes-objects-using-label-selectors",level:3},{value:"<strong>Annotation</strong>",id:"annotation",level:3},{value:"How to add annotation using command line",id:"how-to-add-annotation-using-command-line",level:4},{value:"Delete the annotation",id:"delete-the-annotation",level:4}],u={toc:p},g="wrapper";function d(e){let{components:n,...t}=e;return(0,o.yg)(g,(0,a.A)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"Check out my ",(0,o.yg)("a",{parentName:"p",href:"https://youtu.be/mT-nKvunTvI"},"Youtube")," video on this blog"),(0,o.yg)("p",null,"In this blog, we will explore about Kubernetes Labels and Annotation. We will explain their use cases so that we can decide whether to use labels or annotation for a particular use case."),(0,o.yg)("p",null,"In my previous ",(0,o.yg)("a",{parentName:"p",href:"https://devops4solutions.com/kubernetes-pods-explained-with-examples/"},"blog")," we have already seen different kinds of pods and their life cycle."),(0,o.yg)("p",null,"In general, we always want to organize our pods based on some properties so that we can query against specific pods. To do so we will be add labels to the pods."),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Prerequisite"),":"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Functional ",(0,o.yg)("a",{parentName:"li",href:"https://devops4solutions.com/setup-kubernetes-cluster-in-gcp/"},"Kubernetes Cluster")," configured"),(0,o.yg)("li",{parentName:"ol"},"Kubernetes\u2019 command-line tool, kubectl, which is the command-line interface for running commands against Kubernetes clusters."),(0,o.yg)("li",{parentName:"ol"},"Clone ",(0,o.yg)("a",{parentName:"li",href:"https://github.com/devops4solutions/kubernetes-sample-deployment"},"this")," git repo for all the yaml files which we will be using in this blog")),(0,o.yg)("h3",{id:"agenda"},(0,o.yg)("strong",{parentName:"h3"},"Agenda"),":"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Labels"),(0,o.yg)("li",{parentName:"ol"},"Pod Create with Labels"),(0,o.yg)("li",{parentName:"ol"},"Adding Labels to a Running Pod"),(0,o.yg)("li",{parentName:"ol"},"Select Kubernetes objects using Label selector"),(0,o.yg)("li",{parentName:"ol"},"Modify/Delete the Label"),(0,o.yg)("li",{parentName:"ol"},"Annotation"),(0,o.yg)("li",{parentName:"ol"},"Pod create with Annotation"),(0,o.yg)("li",{parentName:"ol"},"Modify/Delete the annotation")),(0,o.yg)("h3",{id:"labels"},(0,o.yg)("strong",{parentName:"h3"},"Labels")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"They are are the metadata which contain unique information of the Kubernetes objects"),(0,o.yg)("li",{parentName:"ul"},"key-value pair attached to the objects like pod"),(0,o.yg)("li",{parentName:"ul"},"We can attach the label at the time of creation or we can update it at runtime"),(0,o.yg)("li",{parentName:"ul"},"Kubernetes internally maintains the mappings of labels to corresponding objects using optimized data structures to make these queries faster."),(0,o.yg)("li",{parentName:"ul"},"With labels, you can also run your specific pods on selected nodes.")),(0,o.yg)("h4",{id:"organize-pods-by-teamprojectorganization"},(0,o.yg)("strong",{parentName:"h4"},"Organize Pods by team/project/organization")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"You can organize pods so that each team will see only their pods"),(0,o.yg)("li",{parentName:"ul"},"Specific to certain projects")),(0,o.yg)("p",null,"metadata:",(0,o.yg)("br",{parentName:"p"}),"\n","labels:",(0,o.yg)("br",{parentName:"p"}),"\n","environment: development",(0,o.yg)("br",{parentName:"p"}),"\n","team: infra",(0,o.yg)("br",{parentName:"p"}),"\n","project: k8s-infra"),(0,o.yg)("h4",{id:"run-a-pod-on-specific-nodes"},(0,o.yg)("strong",{parentName:"h4"},"Run a Pod on Specific Nodes")),(0,o.yg)("p",null,"This is a very basic requirement when you want to run your pod on a specific node because of its hardware/specific configuration etc."),(0,o.yg)("p",null,"We can do that using ",(0,o.yg)("inlineCode",{parentName:"p"},"node-selector"),"\xa0"),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"nodeSelector:",(0,o.yg)("br",{parentName:"strong"}),"region: east-us",(0,o.yg)("br",{parentName:"strong"}),"disktype: ssd")),(0,o.yg)("h3",{id:"create-a-pod-with-labels"},(0,o.yg)("strong",{parentName:"h3"},"Create a Pod with Labels")),(0,o.yg)("p",null,"kind: Pod",(0,o.yg)("br",{parentName:"p"}),"\n","apiVersion: v1",(0,o.yg)("br",{parentName:"p"}),"\n","metadata:",(0,o.yg)("br",{parentName:"p"}),"\n","name: pod-with-labels",(0,o.yg)("br",{parentName:"p"}),"\n","labels:",(0,o.yg)("br",{parentName:"p"}),"\n","app: nginx",(0,o.yg)("br",{parentName:"p"}),"\n","foo: bar",(0,o.yg)("br",{parentName:"p"}),"\n","spec:",(0,o.yg)("br",{parentName:"p"}),"\n","containers:  "),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"name: first-container",(0,o.yg)("br",{parentName:"li"}),"image: nginx")),(0,o.yg)("p",null,"Create a pod"),(0,o.yg)("p",null,"kubectl create -f pod-with-labels.yaml"),(0,o.yg)("p",null,"kubectl describe pod pod-with-labels"),(0,o.yg)("p",null,(0,o.yg)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/880/1*N2dBEhhEF0RB0FXryJcxQQ.png",alt:null})),(0,o.yg)("h3",{id:"adding-labels-to-a-runningpod"},"Adding Labels to a Running\xa0Pod"),(0,o.yg)("p",null,"You can update the existing label or add the new one using below command"),(0,o.yg)("p",null,"kubectl label pod pod-with-labels app=nginx1 --overwrite",(0,o.yg)("br",{parentName:"p"}),"\n","kubectl label pod pod-with-labels env=dev",(0,o.yg)("br",{parentName:"p"}),"\n","kubectl label pod pod-with-labels team=dev org=abc"),(0,o.yg)("p",null,(0,o.yg)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/880/1*YrLP_UXYheb8DfgD2yShtQ.png",alt:null})),(0,o.yg)("p",null,"How to remove a label"),(0,o.yg)("p",null,"kubectl label pod pod-with-labels env",(0,o.yg)("strong",{parentName:"p"},"-")),(0,o.yg)("h3",{id:"selecting-kubernetes-objects-using-label-selectors"},"Selecting Kubernetes Objects Using Label Selectors"),(0,o.yg)("p",null,"kubectl get pods -l app=nginx1",(0,o.yg)("br",{parentName:"p"}),"\n","kubectl get pods -l app=nginx1,foo=bar"),(0,o.yg)("p",null,(0,o.yg)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/880/1*BWvO7y6Y09f0vgr0Iac-Ig.png",alt:null})),(0,o.yg)("h3",{id:"annotation"},(0,o.yg)("strong",{parentName:"h3"},"Annotation")),(0,o.yg)("p",null,"Annotations are also key-value pairs that can be used to store the unstructured information pertaining to the Kubernetes objects."),(0,o.yg)("p",null,"It can be used to add timestamps, commit SHA, issue tracker links, or names/information about users who are responsible for specific objects in an organization"),(0,o.yg)("p",null,"It can also be used to add information about client libraries or tools."),(0,o.yg)("p",null,"kind: Pod",(0,o.yg)("br",{parentName:"p"}),"\n","apiVersion: v1",(0,o.yg)("br",{parentName:"p"}),"\n","metadata:",(0,o.yg)("br",{parentName:"p"}),"\n","name: pod-with-annotation",(0,o.yg)("br",{parentName:"p"}),"\n","",(0,o.yg)("strong",{parentName:"p"},"annotation:",(0,o.yg)("br",{parentName:"strong"}),"commit-message: testign for nginx",(0,o.yg)("br",{parentName:"strong"}),"owner: Nidhi"),(0,o.yg)("br",{parentName:"p"}),"\n","spec:",(0,o.yg)("br",{parentName:"p"}),"\n","containers:  "),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"name: first-container",(0,o.yg)("br",{parentName:"li"}),"image: nginx")),(0,o.yg)("p",null,"Create a Pod"),(0,o.yg)("p",null,"kubectl create -f pod-with-annotation.yaml"),(0,o.yg)("p",null,"kubectl describe pod pod-with-annotation"),(0,o.yg)("h4",{id:"how-to-add-annotation-using-command-line"},"How to add annotation using command line"),(0,o.yg)("p",null,"kubectl annotate pod pod-with-annotation jiralink=DED-232",(0,o.yg)("br",{parentName:"p"}),"\n","kubectl annotate --overwrite pod <pod","_","name> <annotation","_","key>=<annotation","_","label>"),(0,o.yg)("h4",{id:"delete-the-annotation"},"Delete the annotation"),(0,o.yg)("p",null,"kubectl annotate pod pod-with-annotation jiralink-"),(0,o.yg)("p",null,"You can find more ",(0,o.yg)("a",{parentName:"p",href:"https://devops4solutions.com/category/kubernetes/"},"articles")," on Kubernetes on my website."))}d.isMDXComponent=!0},1873:(e,n,t)=>{t(6540)},5680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>b});var a=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),g=p(t),c=o,b=g["".concat(s,".").concat(c)]||g[c]||d[c]||r;return t?a.createElement(b,l(l({ref:n},u),{},{components:t})):a.createElement(b,l({ref:n},u))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=c;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[g]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<r;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"}}]);